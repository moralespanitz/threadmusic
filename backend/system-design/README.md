# System Design

## Auth Service
- Programming Language: Python
- Framework: Django
- Database: MySQL
- Tables: artists, users, clients

## Business Logic Service
- Programming Language: Typescript
- Framework: NestJS
- Database: Postgres
- Tables: songs, posts

## User Logic Service
- Programming Language: Java
- Framework: Spring
- Database: MongoDB
- Tables: bookmarks, hilos

# ThreadMusic Database Containers

This repository contains Docker configurations for MySQL, PostgreSQL, and MongoDB databases used in the ThreadMusic project.

## Prerequisites

- Docker
- Docker Compose
- OpenSSL (for password generation)

## Environment Setup

The project uses environment variables for configuration. To set up your environment:

1. Generate environment files:
```bash
# For development
./scripts/setup-env.sh dev

# For production
./scripts/setup-env.sh prod
```

2. Review and modify the generated `.env` file as needed.

3. For production, ensure to:
   - Use strong passwords
   - Keep the `.env.prod` file secure
   - Never commit environment files to version control

## Quick Start

To start all database containers:

```bash
docker-compose up -d
```

To stop all containers:

```bash
docker-compose down
```

## Individual Containers

### MySQL
- Port: 3306 (configurable via MYSQL_PORT)
- Default credentials (configurable via .env):
  - Database: threadmusic
  - User: threadmusic
  - Password: (generated by setup script)

### PostgreSQL
- Port: 5432 (configurable via POSTGRES_PORT)
- Default credentials (configurable via .env):
  - Database: threadmusic
  - User: threadmusic
  - Password: (generated by setup script)

### MongoDB
- Port: 27017 (configurable via MONGO_PORT)
- Default credentials (configurable via .env):
  - Database: threadmusic
  - User: threadmusic
  - Password: (generated by setup script)

## Publishing to Docker Hub

To publish these containers to Docker Hub:

1. Login to Docker Hub:
```bash
docker login
```

2. Build and tag the images:
```bash
# For MySQL
docker build -t yourusername/threadmusic-mysql:latest ./containers/mysql
docker push yourusername/threadmusic-mysql:latest

# For PostgreSQL
docker build -t yourusername/threadmusic-postgres:latest ./containers/postgres
docker push yourusername/threadmusic-postgres:latest

# For MongoDB
docker build -t yourusername/threadmusic-mongo:latest ./containers/mongo
docker push yourusername/threadmusic-mongo:latest
```

## Data Persistence

All database data is persisted using Docker volumes:
- mysql_data
- postgres_data
- mongo_data

## Security Best Practices

1. Environment Variables:
   - Never commit `.env` files to version control
   - Use different credentials for development and production
   - Regularly rotate passwords in production
   - Use the provided setup script to generate secure passwords

2. Network Security:
   - All containers are connected through a dedicated bridge network
   - Ports are configurable through environment variables
   - Consider using Docker secrets for production deployments

3. Production Considerations:
   - Use Docker secrets or a secrets management service in production
   - Implement proper backup strategies for the volumes
   - Monitor container logs and resource usage
   - Implement proper access controls and network policies

## Security Note

The default credentials in this setup are for development purposes only. For production use, please:
1. Change all default passwords
2. Use environment variables or Docker secrets for sensitive data
3. Implement proper network security measures




